<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="A braille translator">
	<title>Braille Translator</title>

	<script>
		/**
		 * A script for a loading veil
		 * @author Vera Konigin vera@groundedwren.com
		 * https://groundedwren.neocities.org
		 */
		window.GW = window.GW || {};
		window.GW.Controls = window.GW.Controls || {};
		(function Veil(ns) {
			ns.DeferKeys = {"DOMContentLoaded": true};
			
			/**
			 * Defers the lowering of the veil until a key is cleared
			 * @param {string} key The defer key to keep the veil up
			 */
			ns.addDefer = function addDefer(key) {
				ns.DeferKeys[key] = true;
			}
			
			/**
			 * Marks a defer key as complete and clears the veil if no remain
			 * @param {string} key The key to clear
			 */
			ns.clearDefer = function clearDefer(key) {
				delete ns.DeferKeys[key];
				if(Object.keys(ns.DeferKeys).length === 0) {
					requestAnimationFrame(() => document.getElementById("styGwLoad")?.remove());
				}
			}
			
			document.head.insertAdjacentHTML("beforeend", `
				<style id="styGwLoad">
					body {
						opacity: 0;
					}
					html {
						width: 100vw;
						height: 100vh;
						background-color: var(--veil-light-color, #E3E3E3) !important;
					}
					@media(prefers-color-scheme: dark) {
						html {
							background-color: var(--veil-dark-color, #242424) !important;
						}
					}
				</style>
			`);
			window.addEventListener("DOMContentLoaded", function onDOMContentLoadedVeil() {
				ns.clearDefer("DOMContentLoaded");
				setTimeout(() => document.getElementById("styGwLoad")?.remove(), 3000);
			});
		}) (window.GW.Controls.Veil = window.GW.Controls.Veil || {});
	</script>
	
	<link href="../../Styles/MainBundle.css" rel="stylesheet" type="text/css">
	<link href="../../Styles/InfoDialog.css" rel="stylesheet" type="text/css">
	<script src="../../Scripts/Main.js"></script>

	<script src="../../Scripts/Controls/ShortcutsControl.js"></script>
	<script src="../../Scripts/Controls/SVGIconControl.js"></script>
	<script src="../../Scripts/Controls/ActionBatcherGizmo.js"></script>
	<script src="../../Scripts/Controls/TablistControl.js"></script>
	<script src="../../Scripts/Controls/SwitchControl.js"></script>

	<script src="https://hangman.groundedwren.com/Scripts/Words.js"></script>

	<script src="../../Scripts/Projects/BrailleCell.js"></script>
	<script src="../../Scripts/Projects/Braille.js"></script>

	<style>
		body {
			display: flex;
			flex-direction: column;
		}

		main {
			flex-grow: 1;
			margin-inline: 5px;

			max-width: 1500px;
			margin-inline: auto;
			width: 100%;

			display: grid;
			grid-template-areas:
				"text prac"
				"brai prac";
			grid-template-columns: 1fr auto;
			grid-template-rows: auto 1fr;
			gap: 5px;

			@media(width < 750px) {
				display: flex;
				flex-direction: column;

				#secPractice {
					flex-grow: 1;
					align-items: end;
				}
			}

			section {
				margin: 5px;

				&.collapsed {
					> div {
						display: none;
					}
				}
				&:not(.collapsed) {
					> button {
						display: none;
					}
				}
				> div {
					padding: 5px;
					background-color: var(--background-alt-color);
				}
			}

			blockquote {
				background-color: var(--background-color);
				font-size: 2em;
				min-height: 1lh;
			}
		}

		#secText {
			grid-area: text;

			#hText {
				width: fit-content;
			}

			#txtText {
				width: 100%;
				max-width: 500px;
			}
		}

		#secBraille {
			grid-area: brai;

			&:has(#gwsBraille:focus-within) {
				#spnShort {
					opacity: 1;
				}
			}

			.hdr {
				display: grid;
				grid-template-columns: auto 1fr;
				align-items: center;
				gap: 10px;
			}

			#spnShort {
				opacity: 0;
			}

			#olBraille {
				display: flex;
				flex-direction: row;
				flex-wrap: wrap;

				margin: 0;
				padding: 0;
				list-style: none;

				table {
					width: auto;

					&, :is(tr, td) {
						border: none;
					}
				}
			}
		}

		#secPractice {
			grid-area: prac;
			
			display: grid;
			align-items: start;

			> div {
				min-width: 300px;
				--alt-btn-bakcground-color: var(--background-alt-color);

				> article {
					display: flex;
					flex-direction: column;
					gap: 4px;

					.validity {
						display: flex;
						flex-direction: row;
						gap: 4px;
						background-color: var(--mark-color);
						align-items: center;
						justify-content: center;
					}
				}
			}

			form {
				padding: 5px;
				display: flex;
				flex-direction: row;
				gap: 5px;
				justify-content: space-between;
			}
		}

		.braille-input {
			display: grid;
			grid-template-columns: auto minmax(50px, 1fr);
			justify-items: start;
			align-items: stretch;
			gap: 5px;

			.add-cell-container {
				margin-block-end: 5px;
				display: flex;
				flex-direction: column-reverse;
			}
			
			#btnAddCell {
				max-height: 106px;
				flex-grow: 1;
			}
		}

		.charfig {
			border-block-end: 4px solid transparent;
		}

		.right-content {
			display: grid;
			grid-template-columns: auto auto;
			gap: 5px;

			label {
				padding-inline: 5px !important;
				border-radius: 20px;
			}
		}
	</style>
</head>
<body>
	<gw-site-header
		crumbs="index.html|Grounded Wren; Pages/Projects/index.html|Projects"
		curcrumbtxt="Braille"
		reflowWidth="660px"
	>
		<h1>Braille Translator</h1>
		<div class="right-content">
			<button onclick="document.getElementById('diaInfo').showModal()">
				<gw-icon iconKey="circle-info" name="Info"></gw-icon>
			</button>
			<label>
				<gw-switch><input type="checkbox" id="cbxGrade2" autocomplete="off"></gw-switch>
				Grade 2
			</label>
		</div>
	</gw-site-header>
	<main id="main">
		<gw-shortcuts
			code_1="Alt+G"
			handler_1="GW.Pages.Braille.triggerGenerate(event)"
		>
			<section id="secText" aria-labelledby="hText">
				<div>
					<h2 id="hText" tabindex="-1">Text</h2>
					<input 
						type="text"
						id="txtText"
						aria-labelledby="hText"
						oninput="GW.Pages.Braille.onTxtInput(event)"
						maxlength="50"
						autocomplete="off"
					></textarea>
					<blockquote id="bqText"></blockquote>
				</div>
				<button
					onclick="document.getElementById('secText').classList.remove('collapsed');document.getElementById('hText').focus()"
				>Show Text</button>
			</section>
			<section id="secBraille" aria-labelledby="hBraille">
				<div>
					<div class="hdr">
						<h2 id="hBraille" tabindex="-1">Braille</h2>
						<span id="spnShort" aria-hidden="true"><kbd>Alt</kbd>+<kbd>S</kbd></span>
					</div>
					<div class="braille-input">
						<gw-shortcuts
							id="gwsBraille"
							role="application"
							aria-roledescription="Braille display. Alt+S to show shortcuts."
							code_1="ArrowUp"
							info_1="Up one dot"
							handler_1="GW.Pages.Braille.onBrailleNav(event)"
							code_2="ArrowDown"
							info_2="Down one dot"
							handler_2="GW.Pages.Braille.onBrailleNav(event)"
							code_3="ArrowLeft"
							info_3="Left one dot"
							handler_3="GW.Pages.Braille.onBrailleNav(event)"
							code_4="ArrowRight"
							info_4="Right one dot"
							handler_4="GW.Pages.Braille.onBrailleNav(event)"
							code_5="Home"
							info_5="First cell"
							handler_5="GW.Pages.Braille.onBrailleJump(event)"
							code_6="End"
							info_6="Last cell"
							handler_6="GW.Pages.Braille.onBrailleJump(event)"
							code_7="PageUp"
							info_7="Previous cell"
							handler_7="GW.Pages.Braille.onBrailleJump(event)"
							code_8="PageDown"
							info_8="Next cell"
							handler_8="GW.Pages.Braille.onBrailleJump(event)"
							code_9="Alt+S"
							info_9="Show shortcuts"
							handler_9="GW.Controls.Shortcuts.reportShortcuts(event)"
						>
							<ol id="olBraille"></ol>
						</gw-shortcuts>
						<div class="add-cell-container">
							<button id="btnAddCell" onclick="GW.Pages.Braille.addBrailleCell()">
								<gw-icon name="Add Cell" iconKey="plus"></gw-icon>
							</button>
						</div>
					</div>
					<blockquote id="bqBraille"></blockquote>
				</div>
				<button
					onclick="document.getElementById('secBraille').classList.remove('collapsed');document.getElementById('hBraille').focus()"
				>Show Braille</button>
			</section>
			<section id="secPractice" aria-labelledby="hPractice">
				<div>
					<h2 id="hPractice">Practice</h2>
					<gw-tablist id="tblstExercises" unselectable>
						<fieldset>
							<legend class="sr-only">Exercises</legend>
							<div>
								<button aria-controls="pnlReading"><div class="text">Reading</div></buttton>
								<button aria-controls="pnlWriting"><div class="text">Writing</div></buttton>
							</div>
						</fieldset>
					</gw-tablist>
					<article id="pnlReading">
						<form aria-label="Word generator" onsubmit="GW.Pages.Braille.onGenerateReadingWord(event)">
							<label>
								Word length:
								<input type="number" name="wordLength" required="" max="14" min="4" step="1" value="4">
							</label>
							<button
								type="submit"
								class="generate"
								aria-label="Generate"
								aria-keyshortcuts="Alt+G"
							><u>G</u>enerate</button>
						</form>
						<output id="outReadingWord"></output>
						<output id="outReadingValidity" class="validity"></output>
					</article>
					<article id="pnlWriting">
						<form aria-label="Word generator" onsubmit="GW.Pages.Braille.onGenerateWritingWord(event)">
							<label>
								Word length:
								<input type="number" name="wordLength" required="" max="14" min="4" step="1" value="4">
							</label>
							<button
								type="submit"
								class="generate"
								aria-label="Generate"
								aria-keyshortcuts="Alt+G"
							><u>G</u>enerate</button>
						</form>
						<output id="outWritingWord"></output>
						<output id="outWritingValidity" class="validity"></output>
					</article>
				</div>
			</section>
		</gw-shortcuts>
	</main>
	<footer>
		<gw-buttons-list></gw-buttons-list>
	</footer>
	<dialog id="diaInfo" class="info">
		<article>
			<gw-icon class="info-icon" iconKey="circle-info" name="info" tabindex="-1" role="heading" aria-level="1" autofocus></gw-icon>
			<article>
				<h2>Intro</h2>
				<p>
					Welcome to the Grounded Wren Braille Translator!
				</p>
				<p>
					This page is intended to help (primarily sighted) folks learn braille, as well as easily translate simple phrases.
					 It supports both grade 1 (uncontracted) and 2 (contracted) braille, though grade 2 is missing some shortform words and has a couple bugs.
				</p>
				<p>
					The character to braille map and the dot sequence to unicode maps this tool use are hand-typed, so there may be mistakes.
					 If you find any, please let me know.
				</p>
				<h2>Practice Word Source</h2>
				<p>
					I got the set of available practice words from the list used by the <a href="https://en.wikipedia.org/wiki/Dale%E2%80%93Chall_readability_formula" target="_blank">Dale-Chall readability formula</a>.
					 I pared it down only slightly.
				</p>
				<p>
					Fun fact: this is the same word pool I use in my <a href="https://hangman.groundedwren.com/">Hangman player</a>!
				</p>
				<h2>Other Resources</h2>
				<p>
					I referenced the following sources while composing this translator:
				</p>
				<ul>
					<li><a href="https://www.pharmabraille.com/pharmaceutical-braille/the-braille-alphabet/">pharmabraille.com</a></li>
					<li><a href="https://www.brailleauthority.org/ueb/symbols_list.pdf">brailleauthority.org</a></li>
					<li><a href="https://uebot.niu.edu/courses/pluginfile.php/96/block_html/content/UEB%20List%20of%20Punctuation.pdf">uebot.niu.edu's punctuation list</a></li>
					<li><a href="https://brailletoolbox.com/">brailletoolbox.com</a></li>
					<li><a href="https://www.brailletranslator.org/">brailletranslator.org</a></li>
					<li><a href="https://hadleyhelps.org/sites/default/files/2021-03/Braille%20Quick%20Reference.pdf">hadleyhelps.org</a></li>
				</ul>
				<p>Additionally, I had I'm With Her's <em><a href="https://imwithher.bandcamp.com/album/wild-and-clear-and-blue?search_item_id%3D3053802909%26search_item_type%3Da%26search_match_part%3D%253F%26search_page_id%3D4864672757%26search_page_no%3D0%26search_rank%3D1">Wild and Clear and Blue</a></em> on a loop in the background while coding, so they get a shout out ðŸ˜Š</p>
			</article>
			<footer>
				<a class="full" href="mailto:vera@groundedwren.com?subject=Braille Translator">Give feedback</a>
				<button onclick="document.getElementById('diaInfo').close();">Close</button>
			</footer>
		</article>
	</dialog>
</body>
</html>