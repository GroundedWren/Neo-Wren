<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Wren scratch">
	<title>Writing</title>
	
	<script>
		/**
		 * A script for a loading veil
		 * @author Vera Konigin vera@groundedwren.com
		 * https://groundedwren.neocities.org
		 */
		window.GW = window.GW || {};
		window.GW.Controls = window.GW.Controls || {};
		(function Veil(ns) {
			ns.DeferKeys = {"DOMContentLoaded": true};
			
			/**
			 * Defers the lowering of the veil until a key is cleared
			 * @param {string} key The defer key to keep the veil up
			 */
			ns.addDefer = function addDefer(key) {
				ns.DeferKeys[key] = true;
			}
			
			/**
			 * Marks a defer key as complete and clears the veil if no remain
			 * @param {string} key The key to clear
			 */
			ns.clearDefer = function clearDefer(key) {
				delete ns.DeferKeys[key];
				if(Object.keys(ns.DeferKeys).length === 0) {
					requestAnimationFrame(() => document.getElementById("styGwLoad")?.remove());
				}
			}
			
			document.head.insertAdjacentHTML("beforeend", `
				<style id="styGwLoad">
					body {
						opacity: 0;
					}
					html {
						width: 100vw;
						height: 100vh;
						background-color: var(--veil-light-color, #E3E3E3) !important;
					}
					@media(prefers-color-scheme: dark) {
						html {
							background-color: var(--veil-dark-color, #242424) !important;
						}
					}
				</style>
			`);
			window.addEventListener("DOMContentLoaded", function onDOMContentLoadedVeil() {
				ns.clearDefer("DOMContentLoaded");
				setTimeout(() => document.getElementById("styGwLoad")?.remove(), 3000);
			});
		}) (window.GW.Controls.Veil = window.GW.Controls.Veil || {});
	</script>

	<link href="../Styles/MainBundle.css" rel="stylesheet" type="text/css">
	<script src="../Scripts/Main.js"></script>
	<script src="../Scripts/Controls/TablistControl.js"></script>
	<script src="../Scripts/Controls/RadioMenuControl.js"></script>
	<script src="../Scripts/WritingData.js"></script>
	<script src="../Scripts/Writing.js"></script>

	<style>
		body {
			display: grid;
			grid-template-rows: auto 1fr auto;
			max-height: 100vh;

			@media(height < 515px) {
				max-height: unset;
			}
		}
		main {
			display: grid;
			grid-template-areas:
				"fol fol"
				"pnl frm";
			grid-template-columns: minmax(200px, 20vw) 1fr;
			grid-template-rows: auto 1fr;
			overflow: hidden;
			min-height: 200px;

			@media(width <= 650px) or (height < 515px) {
				display: flex;
				flex-direction: column;
				
				.frame {
					display: none;
				}

				#tblstFolders {
					border-block-end: 1px solid var(--border-color);
				}
			}
			
			#tblstFolders {
				grid-area: fol;
				font-weight: bold;
			}
			#divPanels {
				position: relative;
				grid-area: pnl;
				overflow-y: auto;

				display: grid;
				grid-template-rows: 1fr auto;
				flex-grow: 1;

				gw-radiomenu {
					margin: 5px;
				}

				#artInfo:not(:empty) {
					position: sticky;
					inset-block-end: 0;
					background-color: var(--background-alt-color);
					padding: 4px;

					display: grid;
					row-gap: 2px;
					grid-template-areas:
						"link link"
						"auth time";
					text-align: center;

					a {
						grid-area: link;
					}
					cite {
						grid-area: auth;
					}
					time {
						grid-area: time;
					}
				}
			}
			.frame {
				grid-area: frm;
				width: 100%;
				height: 100%;
				border: 2px inset var(--border-color);
				background: radial-gradient(circle, var(--accent-color) 0%, var(--background-alt-color) 100%);

				iframe {
					width: 100%;
					height: 100%;
					border: none;
					opacity: 0;

					&:not(.empty) {
						transition: opacity ease-in 0.5s;
						opacity: 1;
					}
				}
			}
		}
	</style>
</head>
<body>
	<gw-site-header crumbs="index.html|Grounded Wren" curcrumbtxt="Writing" reflowWidth="650px">
		<h1>Writing</h1>
	</gw-site-header>
	<main id="main">
		<gw-tablist id="tblstFolders">
			<fieldset>
				<legend class="sr-only">Folders</legend>
				<div>
					<button id="btnBlog" aria-controls="pnlBlog"><div class="text">Blog</div></buttton>
					<button aria-controls="pnlFiction"><div class="text">Fiction</div></buttton>
					<button aria-controls="pnlPoetry"><div class="text">Poetry</div></buttton>
				</div>
			</fieldset>
		</gw-tablist>
		<div id="divPanels" tabindex="-1" class="outline-unset">
			<article id="pnlBlog"></article>
			<article id="pnlFiction"></article>
			<article id="pnlPoetry"></article>
			<article id="artInfo"></article>
		</div>
		<div class="frame"><iframe title="" class="empty"></iframe></div>
	</main>
	<footer>
		<gw-buttons-list></gw-buttons-list>
	</footer>
</body>
</html>
